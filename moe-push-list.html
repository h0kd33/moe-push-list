<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/paper-checkbox/paper-checkbox.html">

<dom-module id="moe-push-list">
    <template>
        <style>

            :host {
                display: table;
                box-sizing: border-box;
                outline: 1px solid gray;
                background-color: white;
                padding: 5px 5px;
                color: maroon;
                font-size: 13px;
                clear: both;
                overflow-y: auto;
                font-family: '新細明體', sans-serif;
            }
            /* Custom Style : paper-checkbox */

            #checkbox {
                float: left;
                padding: 3px;
                /*--paper-checkbox-unchecked-color: var(--comment-color);*/
            }

            #checkbox::shadow #checkmark {
                display: none;
            }

            #checkbox::shadow #checkmark {
                display: none;
            }

            #checkbox::shadow #checkbox:not(.checked) {
                border-radius: 8px;
            }

            #checkbox::shadow #checkboxContainer {
                width: 12px;
                height: 12px;
                padding: 3px;
            }
            #push {
                padding: 4px 0;
            }
            #emoji {
                font-family: 'MS Gothic','sans-serif';
            }
            #text {
                line-height: 1.6;
            }
            #idColor {
                display: inline-block;
                float: right;
                height: 0.8em;
                width: 0.4em;
            }
            #content {
                padding: 0 3px;
                min-width: 300px;
            }

            #postInfo {
                color: gray;
                font-size: 10px;
            }

            #openBtn {
                width: 100%;
            }
        </style>
        <div id="container">
            <template id="pushRepeat" is="dom-repeat" items="[[data]]" as="item" observe="data" filter="_pushFilter">
                <template is="dom-if" if="{{isAdmin}}">
                    <paper-checkbox id="checkbox"></paper-checkbox>
                </template>
                <div id="push" class="layout horizontal wrap end-justified">
                    <span id="emoji">(ﾟ∀ﾟ)：<</span>
                    <span id="text" class="flex self-center">[[item.text]]</span>
                    <span id="idColor" style$="{{_computeIdColor(item.idColor)}}" title$="{{item.id}}"></span>
                    <template is="dom-if">
                        <span id="info">[[_computePostInfo(item.id, item.date, item.time)]]</span>
                        <span id="ip">[[item.ip]]</span>
                    </template>
                </div>
            </template>
            <template is="dom-if" if="{{!expand}}">
                <button type="" id="openBtn">閱讀全部({{aboutPush.length}})</button>
            </template>
            <div id="pushForm">
            </div>
        </div>
    </template>

    <script>
        (function(){
            'use strict';


            Polymer({

                is: 'moe-push-list',

                properties: {
                    data: {
                        type: Array,
                        observer: "_dataChanged",
                        value: function() {return []}
                    },
                    aboutPush: {

                    },
                    displayCounts: {
                        type: Number,
                        value: 8
                    },
                    expand: {
                        type: Boolean,
                        value: false,
                        reflectToAttribute: true
                    },
                    maxView: {
                        type: Number,
                        value: 8,
                        observer: '_maxViewChanged'
                    },
                    isAdmin: {
                        value: false
                    }
                },
                expand: function() {
                    this.toggleAttribute( 'expand', true );
                    _pushFilter(null);
                },
                _computePostInfo: function(id, date, time) {
                    return '(' + id + ' ' + date + ' ' + time + ')';
                },
                _computeIdColor: function(color) {
                    return 'background-color: ' + color + ';'
                },
                _dataChanged: function() {
                    console.log(' data initialized ')
                },
                _maxViewChanged: function() {

                },
                _pushFilter: function(item) {
                    if(item === null) return null;
                    console.log( this.data.length);
                    return item.index > this.data.length - this.maxView;
                }
            });
        })();
    </script>
</dom-module>